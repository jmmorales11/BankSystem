’
gC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\Service\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str "
)" #
]# $
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str $
)$ %
]% &
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
["" 
assembly"" 	
:""	 

AssemblyVersion"" 
("" 
$str"" $
)""$ %
]""% &
[## 
assembly## 	
:##	 

AssemblyFileVersion## 
(## 
$str## (
)##( )
]##) *Ä
cC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\Service\Models\EmailRequest.cs
	namespace 	
Service
 
. 
Models 
{ 
public 

class 
EmailRequest 
{		 
public

 
string

 
Email

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
} 
} ‹d
jC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\Service\Controllers\UserController.cs
	namespace 	
Service
 
. 
Controllers 
{ 
public 

class 
UserController 
:  !
ApiController" /
{ 
private 
static 

Dictionary !
<! "
string" (
,( )
string* 0
>0 1
VerificationCodes2 C
=D E
newF I

DictionaryJ T
<T U
stringU [
,[ \
string] c
>c d
(d e
)e f
;f g
private 
readonly 
IEmailService &
_emailService' 4
;4 5
public 
UserController 
( 
) 
{ 	
_emailService 
= 
new 
EmailService  ,
(, -
)- .
;. /
} 	
private 
static 

Dictionary !
<! "
string" (
,( )
User* .
>. / 
PendingRegistrations0 D
=E F
newG J

DictionaryK U
<U V
stringV \
,\ ]
User^ b
>b c
(c d
)d e
;e f
["" 	
HttpPost""	 
]"" 
public## 
async## 
Task## 
<## 
IHttpActionResult## +
>##+ ,

CreateUser##- 7
(##7 8
[##8 9
FromBody##9 A
]##A B
User##C G
newUser##H O
)##O P
{$$ 	
var%% 
BL%% 
=%% 
new%% 
	UserLogic%% "
(%%" #
)%%# $
;%%$ %
try'' 
{(( 
if** 
(** 
BL** 
.**  
validateExistingUser** +
(**+ ,
newUser**, 3
)**3 4
)**4 5
{++ 
return,, 
Content,, "
(,," #
HttpStatusCode,,# 1
.,,1 2

BadRequest,,2 <
,,,< =
new,,> A
{-- 
Success.. 
=..  !
false.." '
,..' (
Message// 
=//  !
$str//" ;
}00 
)00 
;00 
}11 
string33 
verificationCode33 '
=33( )
new33* -
Random33. 4
(334 5
)335 6
.336 7
Next337 ;
(33; <
$num33< B
,33B C
$num33D J
)33J K
.33K L
ToString33L T
(33T U
)33U V
;33V W
VerificationCodes66 !
[66! "
newUser66" )
.66) *
email66* /
]66/ 0
=661 2
verificationCode663 C
;66C D 
PendingRegistrations77 $
[77$ %
newUser77% ,
.77, -
email77- 2
]772 3
=774 5
newUser776 =
;77= >
string:: 
subject:: 
=::  
$str::! G
;::G H
string;; 
body;; 
=;; 
$";;  
$str;;  F
{;;F G
verificationCode;;G W
};;W X
$str;;X a
";;a b
;;;b c
await<< 
_emailService<< #
.<<# $
SendEmailAsync<<$ 2
(<<2 3
newUser<<3 :
.<<: ;
email<<; @
,<<@ A
subject<<B I
,<<I J
body<<K O
)<<O P
;<<P Q
var?? 
response?? 
=?? 
new?? " 
UserCreationResponse??# 7
{@@ 
UserAA 
=AA 
newUserAA "
,AA" #
SuccessBB 
=BB 
trueBB "
,BB" #
MessageCC 
=CC 
$str	CC €
}DD 
;DD 
returnFF 
OkFF 
(FF 
responseFF "
)FF" #
;FF# $
}GG 
catchHH 
(HH 
	ExceptionHH 
exHH 
)HH  
{II 
returnJJ 
ContentJJ 
(JJ 
HttpStatusCodeJJ -
.JJ- .
InternalServerErrorJJ. A
,JJA B
newJJC F
{KK 
SuccessLL 
=LL 
falseLL #
,LL# $
MessageMM 
=MM 
$strMM P
}NN 
)NN 
;NN 
}OO 
}PP 	
[TT 	
HttpPostTT	 
]TT 
publicUU 
IHttpActionResultUU  
VerifyAndCreateUserUU! 4
(UU4 5
[UU5 6
FromBodyUU6 >
]UU> ?
VerifyCodeRequestUU@ Q
verifyRequestUUR _
)UU_ `
{VV 	
varWW 
BLWW 
=WW 
newWW 
	UserLogicWW "
(WW" #
)WW# $
;WW$ %
ifZZ 
(ZZ 
VerificationCodesZZ !
.ZZ! "
TryGetValueZZ" -
(ZZ- .
verifyRequestZZ. ;
.ZZ; <
EmailZZ< A
,ZZA B
outZZC F
stringZZG M

storedCodeZZN X
)ZZX Y
&&ZZZ \

storedCodeZZ] g
==ZZh j
verifyRequestZZk x
.ZZx y
CodeZZy }
)ZZ} ~
{[[ 
VerificationCodes]] !
.]]! "
Remove]]" (
(]]( )
verifyRequest]]) 6
.]]6 7
Email]]7 <
)]]< =
;]]= >
if`` 
(``  
PendingRegistrations`` (
.``( )
TryGetValue``) 4
(``4 5
verifyRequest``5 B
.``B C
Email``C H
,``H I
out``J M
User``N R
newUser``S Z
)``Z [
)``[ \
{aa 
varcc 
createdUsercc #
=cc$ %
BLcc& (
.cc( )
Createcc) /
(cc/ 0
newUsercc0 7
)cc7 8
;cc8 9 
PendingRegistrationsff (
.ff( )
Removeff) /
(ff/ 0
verifyRequestff0 =
.ff= >
Emailff> C
)ffC D
;ffD E
returnjj 
Okjj 
(jj 
newjj !
{jj" #
Messagejj$ +
=jj, -
$strjj. L
,jjL M
UserjjN R
=jjS T
createdUserjjU `
}jja b
)jjb c
;jjc d
}kk 
elsell 
{mm 
returnnn 
Contentnn "
(nn" #
HttpStatusCodenn# 1
.nn1 2
NotFoundnn2 :
,nn: ;
newnn< ?
{nn@ A
MessagennB I
=nnJ K
$str	nnL ƒ
}
nn„ …
)
nn… †
;
nn† ‡
}oo 
}pp 
elseqq 
{rr 
returnss 
Contentss 
(ss 
HttpStatusCodess -
.ss- .
Unauthorizedss. :
,ss: ;
newss< ?
{ss@ A
MessagessB I
=ssJ K
$strssL y
}ssz {
)ss{ |
;ss| }
}tt 
}uu 	
[xx 	
HttpPostxx	 
]xx 
publicyy 
asyncyy 
Taskyy 
<yy 
IHttpActionResultyy +
>yy+ ,
Loginyy- 2
(yy2 3
[yy3 4
FromBodyyy4 <
]yy< =
LoginRequestyy> J
loginRequestyyK W
)yyW X
{zz 	
var{{ 
BL{{ 
={{ 
new{{ 
	UserLogic{{ "
({{" #
){{# $
;{{$ %
try}} 
{~~ 
var
€€ 
user
€€ 
=
€€ 
BL
€€ 
.
€€ 
Authenticate
€€ *
(
€€* +
loginRequest
€€+ 7
.
€€7 8
Email
€€8 =
,
€€= >
loginRequest
€€? K
.
€€K L
Password
€€L T
)
€€T U
;
€€U V
if
‚‚ 
(
‚‚ 
user
‚‚ 
==
‚‚ 
null
‚‚  
)
‚‚  !
{
ƒƒ 
return
„„ 
Content
„„ "
(
„„" #
HttpStatusCode
„„# 1
.
„„1 2
Unauthorized
„„2 >
,
„„> ?
new
„„@ C
{
„„D E
Success
„„F M
=
„„N O
false
„„P U
,
„„U V
Message
„„W ^
=
„„_ `
$str
„„a |
}
„„} ~
)
„„~ 
;„„ €
}
…… 
string
ˆˆ 
verificationCode
ˆˆ '
=
ˆˆ( )
new
ˆˆ* -
Random
ˆˆ. 4
(
ˆˆ4 5
)
ˆˆ5 6
.
ˆˆ6 7
Next
ˆˆ7 ;
(
ˆˆ; <
$num
ˆˆ< B
,
ˆˆB C
$num
ˆˆD J
)
ˆˆJ K
.
ˆˆK L
ToString
ˆˆL T
(
ˆˆT U
)
ˆˆU V
;
ˆˆV W
VerificationCodes
‹‹ !
[
‹‹! "
loginRequest
‹‹" .
.
‹‹. /
Email
‹‹/ 4
]
‹‹4 5
=
‹‹6 7
verificationCode
‹‹8 H
;
‹‹H I
string
ŽŽ 
subject
ŽŽ 
=
ŽŽ  
$str
ŽŽ! 9
;
ŽŽ9 :
string
 
body
 
=
 
$"
  
$str
  F
{
F G
verificationCode
G W
}
W X
$str
X a
"
a b
;
b c
await
 
_emailService
 #
.
# $
SendEmailAsync
$ 2
(
2 3
loginRequest
3 ?
.
? @
Email
@ E
,
E F
subject
G N
,
N O
body
P T
)
T U
;
U V
return
““ 
Ok
““ 
(
““ 
new
““ 
{
”” 
Success
•• 
=
•• 
true
•• "
,
••" #
Email
–– 
=
–– 
loginRequest
–– (
.
––( )
Email
––) .
,
––. /
Message
—— 
=
—— 
$str
—— x
}
˜˜ 
)
˜˜ 
;
˜˜ 
}
™™ 
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš  
{
›› 
return
œœ 
Content
œœ 
(
œœ 
HttpStatusCode
œœ -
.
œœ- .!
InternalServerError
œœ. A
,
œœA B
new
œœC F
{
œœG H
Success
œœI P
=
œœQ R
false
œœS X
,
œœX Y
Message
œœZ a
=
œœb c
$str
œœd |
+
œœ} ~
exœœ 
.œœ ‚
Messageœœ‚ ‰
}œœŠ ‹
)œœ‹ Œ
;œœŒ 
}
 
}
žž 	
[
££ 	
HttpPost
££	 
]
££ 
public
¤¤ 
IHttpActionResult
¤¤  

VerifyCode
¤¤! +
(
¤¤+ ,
[
¤¤, -
FromBody
¤¤- 5
]
¤¤5 6
VerifyCodeRequest
¤¤7 H
verifyRequest
¤¤I V
)
¤¤V W
{
¥¥ 	
if
¦¦ 
(
¦¦ 
VerificationCodes
¦¦ !
.
¦¦! "
TryGetValue
¦¦" -
(
¦¦- .
verifyRequest
¦¦. ;
.
¦¦; <
Email
¦¦< A
,
¦¦A B
out
¦¦C F
string
¦¦G M

storedCode
¦¦N X
)
¦¦X Y
&&
¦¦Z \

storedCode
¦¦] g
==
¦¦h j
verifyRequest
¦¦k x
.
¦¦x y
Code
¦¦y }
)
¦¦} ~
{
§§ 
string
¬¬ 
userRole
¬¬ 
=
¬¬  !
$str
¬¬" (
;
¬¬( )
var
¯¯ 
token
¯¯ 
=
¯¯ 

JwtService
¯¯ &
.
¯¯& '
GenerateToken
¯¯' 4
(
¯¯4 5
verifyRequest
¯¯5 B
.
¯¯B C
Email
¯¯C H
,
¯¯H I
userRole
¯¯J R
)
¯¯R S
;
¯¯S T
return
±± 
Ok
±± 
(
±± 
new
±± 
{
²² 
Token
³³ 
=
³³ 
token
³³ !
,
³³! "
Email
´´ 
=
´´ 
verifyRequest
´´ )
.
´´) *
Email
´´* /
,
´´/ 0
Role
µµ 
=
µµ 
userRole
µµ #
,
µµ# $
Message
¶¶ 
=
¶¶ 
$str
¶¶ -
}
·· 
)
·· 
;
·· 
}
¸¸ 
else
¹¹ 
{
ºº 
return
»» 
Content
»» 
(
»» 
HttpStatusCode
»» -
.
»»- .
Unauthorized
»». :
,
»»: ;
new
»»< ?
{
»»@ A
Message
»»B I
=
»»J K
$str
»»L y
}
»»z {
)
»»{ |
;
»»| }
}
¼¼ 
}
½½ 	
}
¾¾ 
}¿¿ «
[C:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\Service\Global.asax.cs
	namespace 	
Service
 
{		 
public

 

class

 
WebApiApplication

 "
:

# $
System

% +
.

+ ,
Web

, /
.

/ 0
HttpApplication

0 ?
{ 
	protected 
void 
Application_Start (
(( )
)) *
{ 	
GlobalConfiguration 
.  
	Configure  )
() *
WebApiConfig* 6
.6 7
Register7 ?
)? @
;@ A
} 	
} 
} ð(
jC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\Service\Controllers\LoanController.cs
	namespace 	
Service
 
. 
Controllers 
{ 
public 

class 
LoanController 
:  !
ApiController" /
{ 
[ 	
HttpPost	 
] 
public 
IHttpActionResult  

CreateLoan! +
(+ ,
[, -
FromBody- 5
]5 6
Loan7 ;
newLoan< C
)C D
{ 	
var 
	loanLogic 
= 
new 
	LoanLogic  )
() *
)* +
;+ ,
try 
{ 
var 
createdLoan 
=  !
	loanLogic" +
.+ ,
Create, 2
(2 3
newLoan3 :
): ;
;; <
return 
Ok 
( 
new 
{ 
Message  '
=( )
$str* H
,H I
LoanJ N
=O P
createdLoanQ \
}] ^
)^ _
;_ `
} 
catch 
( 
	Exception 
ex 
)  
{ 
return 

BadRequest !
(! "
ex" $
.$ %
Message% ,
), -
;- .
} 
} 	
[!! 	
HttpGet!!	 
]!! 
public"" 
IHttpActionResult""  
GetAllLoans""! ,
("", -
)""- .
{## 	
var$$ 
	loanLogic$$ 
=$$ 
new$$ 
	LoanLogic$$  )
($$) *
)$$* +
;$$+ ,
try%% 
{&& 
var'' 
loans'' 
='' 
	loanLogic'' %
.''% &
RetrieveAllLoan''& 5
(''5 6
)''6 7
;''7 8
return(( 
Ok(( 
((( 
new(( 
{(( 
Loans((  %
=((& '
loans((( -
}((. /
)((/ 0
;((0 1
})) 
catch** 
(** 
	Exception** 
ex** 
)**  
{++ 
return,, 
InternalServerError,, *
(,,* +
ex,,+ -
),,- .
;,,. /
}-- 
}.. 	
[11 	
HttpGet11	 
]11 
public22 
IHttpActionResult22  
GetLoanById22! ,
(22, -
int22- 0
id221 3
)223 4
{33 	
var44 
	loanLogic44 
=44 
new44 
	LoanLogic44  )
(44) *
)44* +
;44+ ,
try55 
{66 
var77 
loan77 
=77 
	loanLogic77 $
.77$ %
RetrieveByIdLoan77% 5
(775 6
id776 8
)778 9
;779 :
if88 
(88 
loan88 
==88 
null88  
)88  !
{99 
return:: 
Content:: "
(::" #
HttpStatusCode::# 1
.::1 2
NotFound::2 :
,::: ;
new::< ?
{::@ A
Message::B I
=::J K
$str::L d
}::e f
)::f g
;::g h
};; 
return<< 
Ok<< 
(<< 
new<< 
{<< 
Loan<<  $
=<<% &
loan<<' +
}<<, -
)<<- .
;<<. /
}== 
catch>> 
(>> 
	Exception>> 
ex>> 
)>>  
{?? 
return@@ 
InternalServerError@@ *
(@@* +
ex@@+ -
)@@- .
;@@. /
}AA 
}BB 	
[EE 	

HttpDeleteEE	 
]EE 
publicFF 
IHttpActionResultFF  

DeleteLoanFF! +
(FF+ ,
intFF, /
idFF0 2
)FF2 3
{GG 	
varHH 
	loanLogicHH 
=HH 
newHH 
	LoanLogicHH  )
(HH) *
)HH* +
;HH+ ,
tryII 
{JJ 
boolKK 
deletedKK 
=KK 
	loanLogicKK (
.KK( )
DeleteKK) /
(KK/ 0
idKK0 2
)KK2 3
;KK3 4
ifLL 
(LL 
!LL 
deletedLL 
)LL 
{MM 
returnNN 
ContentNN "
(NN" #
HttpStatusCodeNN# 1
.NN1 2
NotFoundNN2 :
,NN: ;
newNN< ?
{NN@ A
MessageNNB I
=NNJ K
$strNNL z
}NN{ |
)NN| }
;NN} ~
}OO 
returnQQ 
OkQQ 
(QQ 
newQQ 
{QQ 
MessageQQ  '
=QQ( )
$strQQ* K
}QQL M
)QQM N
;QQN O
}RR 
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS  
{TT 
returnUU 
InternalServerErrorUU *
(UU* +
exUU+ -
)UU- .
;UU. /
}VV 
}WW 	
}XX 
}YY  
fC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\Service\App_Start\WebApiConfig.cs
	namespace 	
Service
 
{ 
public 

static 
class 
WebApiConfig $
{		 
public

 
static

 
void

 
Register

 #
(

# $
HttpConfiguration

$ 5
config

6 <
)

< =
{ 	
config 
. "
MapHttpAttributeRoutes )
() *
)* +
;+ ,
config 
. 
Routes 
. 
MapHttpRoute &
(& '
name 
: 
$str "
," #
routeTemplate 
: 
$str ?
,? @
defaults 
: 
new 
{ 
id  "
=# $
RouteParameter% 3
.3 4
Optional4 <
}= >
) 
; 
} 	
} 
} 