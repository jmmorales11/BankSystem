é
cC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\BLL\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 
) 
]  
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str  
)  !
]! "
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[   
assembly   	
:  	 

AssemblyVersion   
(   
$str   $
)  $ %
]  % &
[!! 
assembly!! 	
:!!	 

AssemblyFileVersion!! 
(!! 
$str!! (
)!!( )
]!!) *€Q
UC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\BLL\UserLogic.cs
	namespace 	
BLL
 
{ 
public 

class 
	UserLogic 
{ 
public 
( 
bool 
Success 
, 
string $
Message% ,
,, -
List. 2
<2 3
User3 7
>7 8
UserList9 A
)A B
RetrieveAllUserC R
(R S
)S T
{ 	
try 
{ 
using 
( 
var 
r 
= 
RepositoryFactory 0
.0 1
CreateRepository1 A
(A B
)B C
)C D
{ 
var 
userList  
=! "
r# $
.$ %
RetrieveAll% 0
<0 1
User1 5
>5 6
(6 7
)7 8
;8 9
return 
( 
true  
,  !
$str" E
,E F
userListG O
)O P
;P Q
} 
} 
catch 
( 
	Exception 
ex 
)  
{ 
return 
( 
false 
, 
$" !
$str! >
{> ?
ex? A
.A B
MessageB I
}I J
"J K
,K L
nullM Q
)Q R
;R S
} 
} 	
public   
(   
bool   
Success   
,   
string   $
Message  % ,
,  , -
User  . 2
User  3 7
)  7 8
RetrieveByIdUser  9 I
(  I J
int  J M
id  N P
)  P Q
{!! 	
try"" 
{## 
using$$ 
($$ 
var$$ 
r$$ 
=$$ 
RepositoryFactory$$ 0
.$$0 1
CreateRepository$$1 A
($$A B
)$$B C
)$$C D
{%% 
var&& 
user&& 
=&& 
r&&  
.&&  !
Retrieve&&! )
<&&) *
User&&* .
>&&. /
(&&/ 0
p&&0 1
=>&&2 4
p&&5 6
.&&6 7
user_id&&7 >
==&&? A
id&&B D
)&&D E
;&&E F
if'' 
('' 
user'' 
=='' 
null''  $
)''$ %
{(( 
return)) 
())  
false))  %
,))% &
$str))' >
,))> ?
null))@ D
)))D E
;))E F
}** 
return++ 
(++ 
true++  
,++  !
$str++" 6
,++6 7
user++8 <
)++< =
;++= >
},, 
}-- 
catch.. 
(.. 
	Exception.. 
ex.. 
)..  
{// 
return00 
(00 
false00 
,00 
$"00 !
$str00! =
{00= >
ex00> @
.00@ A
Message00A H
}00H I
"00I J
,00J K
null00L P
)00P Q
;00Q R
}11 
}22 	
public44 
(44 
bool44 
Success44 
,44 
string44 $
Message44% ,
)44, -
Delete44. 4
(444 5
int445 8
id449 ;
)44; <
{55 	
try66 
{77 
var88 
user88 
=88 
RetrieveByIdUser88 +
(88+ ,
id88, .
)88. /
.88/ 0
User880 4
;884 5
if99 
(99 
user99 
==99 
null99  
)99  !
{:: 
return;; 
(;; 
false;; !
,;;! "
$str;;# :
);;: ;
;;;; <
}<< 
using>> 
(>> 
var>> 
r>> 
=>> 
RepositoryFactory>> 0
.>>0 1
CreateRepository>>1 A
(>>A B
)>>B C
)>>C D
{?? 
bool@@ 
deleted@@  
=@@! "
r@@# $
.@@$ %
Delete@@% +
(@@+ ,
user@@, 0
)@@0 1
;@@1 2
returnAA 
deletedAA "
?BB 
(BB 
trueBB 
,BB  
$strBB! A
)BBA B
:CC 
(CC 
falseCC  
,CC  !
$strCC" B
)CCB C
;CCC D
}DD 
}EE 
catchFF 
(FF 
	ExceptionFF 
exFF 
)FF  
{GG 
returnHH 
(HH 
falseHH 
,HH 
$"HH !
$strHH! <
{HH< =
exHH= ?
.HH? @
MessageHH@ G
}HHG H
"HHH I
)HHI J
;HHJ K
}II 
}JJ 	
publicLL 
(LL 
boolLL 
SuccessLL 
,LL 
stringLL $
MessageLL% ,
)LL, -

UpdateUserLL. 8
(LL8 9
UserLL9 =
userLL> B
)LLB C
{MM 	
tryNN 
{OO 
usingPP 
(PP 
varPP 
rPP 
=PP 
RepositoryFactoryPP 0
.PP0 1
CreateRepositoryPP1 A
(PPA B
)PPB C
)PPC D
{QQ 
boolRR 
updatedRR  
=RR! "
rRR# $
.RR$ %
UpdateRR% +
(RR+ ,
userRR, 0
)RR0 1
;RR1 2
returnSS 
updatedSS "
?TT 
(TT 
trueTT 
,TT  
$strTT! C
)TTC D
:UU 
(UU 
falseUU  
,UU  !
$strUU" D
)UUD E
;UUE F
}VV 
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX  
{YY 
returnZZ 
(ZZ 
falseZZ 
,ZZ 
$"ZZ !
$strZZ! >
{ZZ> ?
exZZ? A
.ZZA B
MessageZZB I
}ZZI J
"ZZJ K
)ZZK L
;ZZL M
}[[ 
}\\ 	
public__ 
User__ 
Create__ 
(__ 
User__ 
users__  %
)__% &
{`` 	
Useraa 
resaa 
=aa 
nullaa 
;aa 
usingbb 
(bb 
varbb 
rbb 
=bb 
RepositoryFactorybb ,
.bb, -
CreateRepositorybb- =
(bb= >
)bb> ?
)bb? @
{cc 
usersdd 
.dd 
statusdd 
=dd 
$numdd  
;dd  !
usersee 
.ee 
registration_dateee '
=ee( )
DateTimeee* 2
.ee2 3
Nowee3 6
;ee6 7
usersff 
.ff 
roleff 
=ff 
$strff %
;ff% &
reshh 
=hh 
rhh 
.hh 
Createhh 
(hh 
usershh $
)hh$ %
;hh% &
returnjj 
resjj 
;jj 
}kk 
}mm 	
publicoo 
Useroo 

CreateUseroo 
(oo 
Useroo #
usersoo$ )
)oo) *
{pp 	
Userqq 
resqq 
=qq 
nullqq 
;qq 
usingrr 
(rr 
varrr 
rrr 
=rr 
RepositoryFactoryrr ,
.rr, -
CreateRepositoryrr- =
(rr= >
)rr> ?
)rr? @
{ss 
userstt 
.tt 
statustt 
=tt 
$numtt  
;tt  !
usersuu 
.uu 
registration_dateuu '
=uu( )
DateTimeuu* 2
.uu2 3
Nowuu3 6
;uu6 7
resww 
=ww 
rww 
.ww 
Createww 
(ww 
usersww $
)ww$ %
;ww% &
returnyy 
resyy 
;yy 
}zz 
}|| 	
public~~ 
bool~~  
validateExistingUser~~ (
(~~( )
User~~) -
user~~. 2
)~~2 3
{ 	
using
ÄÄ 
(
ÄÄ 
var
ÄÄ 
r
ÄÄ 
=
ÄÄ 
RepositoryFactory
ÄÄ ,
.
ÄÄ, -
CreateRepository
ÄÄ- =
(
ÄÄ= >
)
ÄÄ> ?
)
ÄÄ? @
{
ÅÅ 
User
ÇÇ 
existingUser
ÇÇ !
=
ÇÇ" #
r
ÇÇ$ %
.
ÇÇ% &
Retrieve
ÇÇ& .
<
ÇÇ. /
User
ÇÇ/ 3
>
ÇÇ3 4
(
ÇÇ4 5
u
ÇÇ5 6
=>
ÇÇ7 9
u
ÇÇ: ;
.
ÇÇ; <
email
ÇÇ< A
==
ÇÇB D
user
ÇÇE I
.
ÇÇI J
email
ÇÇJ O
)
ÇÇO P
;
ÇÇP Q
if
ÉÉ 
(
ÉÉ 
existingUser
ÉÉ 
!=
ÉÉ  "
null
ÉÉ# '
)
ÉÉ' (
{
ÑÑ 
return
ÖÖ 
true
ÖÖ 
;
ÖÖ  
}
ÜÜ 
else
áá 
{
àà 
return
ââ 
false
ââ  
;
ââ  !
}
ää 
}
ãã 
}
çç 	
public
èè 
User
èè 
Authenticate
èè  
(
èè  !
string
èè! '
email
èè( -
,
èè- .
string
èè/ 5
password
èè6 >
)
èè> ?
{
êê 	
using
ëë 
(
ëë 
var
ëë 
r
ëë 
=
ëë 
RepositoryFactory
ëë ,
.
ëë, -
CreateRepository
ëë- =
(
ëë= >
)
ëë> ?
)
ëë? @
{
íí 
User
ìì 
user
ìì 
=
ìì 
r
ìì 
.
ìì 
Retrieve
ìì &
<
ìì& '
User
ìì' +
>
ìì+ ,
(
ìì, -
u
ìì- .
=>
ìì/ 1
u
ìì2 3
.
ìì3 4
email
ìì4 9
==
ìì: <
email
ìì= B
&&
ììC E
u
ììF G
.
ììG H
password
ììH P
==
ììQ S
password
ììT \
)
ìì\ ]
;
ìì] ^
return
ïï 
user
ïï 
;
ïï 
}
ññ 
}
óó 	
}
úú 
}ùù œ<
YC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\BLL\UserDataLogic.cs
	namespace 	
BLL
 
{ 
public 

class 
UserDataLogic 
{		 
public

 
(

 
bool

 
Success

 
,

 
string

 $
Message

% ,
,

, -
	User_Data

. 7
CreatedUserData

8 G
)

G H
Create

I O
(

O P
	User_Data

P Y
users

Z _
)

_ `
{ 	
try 
{ 
using 
( 
var 
r 
= 
RepositoryFactory 0
.0 1
CreateRepository1 A
(A B
)B C
)C D
{ 
var 
createdUserData '
=( )
r* +
.+ ,
Create, 2
(2 3
users3 8
)8 9
;9 :
return 
( 
true  
,  !
$str" I
,I J
createdUserDataK Z
)Z [
;[ \
} 
} 
catch 
( 
	Exception 
ex 
)  
{ 
return 
( 
false 
, 
$" !
$str! B
{B C
exC E
.E F
MessageF M
}M N
"N O
,O P
nullQ U
)U V
;V W
} 
} 	
public 
( 
bool 
Success 
, 
string $
Message% ,
,, -
List. 2
<2 3
	User_Data3 <
>< =
UserDataList> J
)J K
RetrieveAllUserDataL _
(_ `
)` a
{ 	
try 
{ 
using 
( 
var 
r 
= 
RepositoryFactory 0
.0 1
CreateRepository1 A
(A B
)B C
)C D
{ 
var   
userDataList   $
=  % &
r  ' (
.  ( )
RetrieveAll  ) 4
<  4 5
	User_Data  5 >
>  > ?
(  ? @
)  @ A
;  A B
return!! 
(!! 
true!!  
,!!  !
$str!!" B
,!!B C
userDataList!!D P
)!!P Q
;!!Q R
}"" 
}## 
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$  
{%% 
return&& 
(&& 
false&& 
,&& 
$"&& !
$str&&! ;
{&&; <
ex&&< >
.&&> ?
Message&&? F
}&&F G
"&&G H
,&&H I
null&&J N
)&&N O
;&&O P
}'' 
}(( 	
public++ 
(++ 
bool++ 
Success++ 
,++ 
string++ $
Message++% ,
,++, -
	User_Data++. 7
UserData++8 @
)++@ A 
RetrieveByIdUserData++B V
(++V W
int++W Z
id++[ ]
)++] ^
{,, 	
try-- 
{.. 
using// 
(// 
var// 
r// 
=// 
RepositoryFactory// 0
.//0 1
CreateRepository//1 A
(//A B
)//B C
)//C D
{00 
var11 
userData11  
=11! "
r11# $
.11$ %
Retrieve11% -
<11- .
	User_Data11. 7
>117 8
(118 9
p119 :
=>11; =
p11> ?
.11? @
user_id11@ G
==11H J
id11K M
)11M N
;11N O
if22 
(22 
userData22  
==22! #
null22$ (
)22( )
{33 
return44 
(44  
false44  %
,44% &
$str44' H
,44H I
null44J N
)44N O
;44O P
}55 
return66 
(66 
true66  
,66  !
$str66" @
,66@ A
userData66B J
)66J K
;66K L
}77 
}88 
catch99 
(99 
	Exception99 
ex99 
)99  
{:: 
return;; 
(;; 
false;; 
,;; 
$";; !
$str;;! F
{;;F G
ex;;G I
.;;I J
Message;;J Q
};;Q R
";;R S
,;;S T
null;;U Y
);;Y Z
;;;Z [
}<< 
}== 	
public?? 
(?? 
bool?? 
Success?? 
,?? 
string?? $
Message??% ,
)??, -
Delete??. 4
(??4 5
int??5 8
id??9 ;
)??; <
{@@ 	
tryAA 
{BB 
varCC 
userCC 
=CC  
RetrieveByIdUserDataCC /
(CC/ 0
idCC0 2
)CC2 3
.CC3 4
UserDataCC4 <
;CC< =
ifDD 
(DD 
userDD 
==DD 
nullDD  
)DD  !
{EE 
returnFF 
(FF 
falseFF !
,FF! "
$strFF# D
)FFD E
;FFE F
}GG 
usingII 
(II 
varII 
rII 
=II 
RepositoryFactoryII 0
.II0 1
CreateRepositoryII1 A
(IIA B
)IIB C
)IIC D
{JJ 
boolKK 
deletedKK  
=KK! "
rKK# $
.KK$ %
DeleteKK% +
(KK+ ,
userKK, 0
)KK0 1
;KK1 2
returnLL 
deletedLL "
?MM 
(MM 
trueMM 
,MM  
$strMM! K
)MMK L
:NN 
(NN 
falseNN  
,NN  !
$strNN" P
)NNP Q
;NNQ R
}OO 
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
exQQ 
)QQ  
{RR 
returnSS 
(SS 
falseSS 
,SS 
$"SS !
$strSS! E
{SSE F
exSSF H
.SSH I
MessageSSI P
}SSP Q
"SSQ R
)SSR S
;SSS T
}TT 
}UU 	
publicWW 
(WW 
boolWW 
SuccessWW 
,WW 
stringWW $
MessageWW% ,
)WW, -
UpdateUser_DataWW. =
(WW= >
	User_DataWW> G
	user_DataWWH Q
)WWQ R
{XX 	
tryYY 
{ZZ 
using[[ 
([[ 
var[[ 
r[[ 
=[[ 
RepositoryFactory[[ 0
.[[0 1
CreateRepository[[1 A
([[A B
)[[B C
)[[C D
{\\ 
bool]] 
updated]]  
=]]! "
r]]# $
.]]$ %
Update]]% +
(]]+ ,
	user_Data]], 5
)]]5 6
;]]6 7
return^^ 
updated^^ "
?__ 
(__ 
true__ 
,__  
$str__! M
)__M N
:`` 
(`` 
false``  
,``  !
$str``" R
)``R S
;``S T
}aa 
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
returnee 
(ee 
falseee 
,ee 
$"ee !
$stree! G
{eeG H
exeeH J
.eeJ K
MessageeeK R
}eeR S
"eeS T
)eeT U
;eeU V
}ff 
}gg 	
}hh 
}ii Ëm
UC:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\BLL\LoanLogic.cs
	namespace 	
BLL
 
{ 
public		 

class		 
	LoanLogic		 
{

 
public 
( 
bool 
Success 
, 
string $
Message% ,
,, -
Loan. 2
CreatedLoan3 >
)> ?
Create@ F
(F G
LoanG K
loanL P
)P Q
{ 	
var 
eligibility 
= #
ValidateLoanEligibility 5
(5 6
loan6 :
): ;
;; <
if 
( 
! 
eligibility 
. 

IsEligible '
)' (
{ 
return 
( 
false 
, 
eligibility *
.* +
Message+ 2
,2 3
null4 8
)8 9
;9 :
} 
try 
{ 
using 
( 
var 
r 
= 
RepositoryFactory 0
.0 1
CreateRepository1 A
(A B
)B C
)C D
{ 
loan 
. 
application_date )
=* +
DateTime, 4
.4 5
Now5 8
;8 9
var 
createdLoan #
=$ %
r& '
.' (
Create( .
(. /
loan/ 3
)3 4
;4 5
return 
( 
true  
,  !
$str" @
,@ A
createdLoanB M
)M N
;N O
} 
} 
catch 
( 
	Exception 
ex 
)  
{ 
return 
( 
false 
, 
$" !
$str! =
{= >
ex> @
.@ A
MessageA H
}H I
"I J
,J K
nullL P
)P Q
;Q R
}   
}!! 	
public$$ 
($$ 
bool$$ 
Success$$ 
,$$ 
string$$ $
Message$$% ,
,$$, -
List$$. 2
<$$2 3
Loan$$3 7
>$$7 8
Loans$$9 >
)$$> ?
RetrieveAllLoan$$@ O
($$O P
)$$P Q
{%% 	
try&& 
{'' 
using(( 
((( 
var(( 
r(( 
=(( 
RepositoryFactory(( 0
.((0 1
CreateRepository((1 A
(((A B
)((B C
)((C D
{)) 
var** 
loans** 
=** 
r**  !
.**! "
RetrieveAll**" -
<**- .
Loan**. 2
>**2 3
(**3 4
)**4 5
;**5 6
return++ 
(++ 
true++  
,++  !
$str++" F
,++F G
loans++H M
)++M N
;++N O
},, 
}-- 
catch.. 
(.. 
	Exception.. 
ex.. 
)..  
{// 
return00 
(00 
false00 
,00 
$"00 !
$str00! C
{00C D
ex00D F
.00F G
Message00G N
}00N O
"00O P
,00P Q
null00R V
)00V W
;00W X
}11 
}22 	
public44 
(44 
bool44 
Success44 
,44 
string44 $
Message44% ,
,44, -
Loan44. 2
Loan443 7
)447 8
RetrieveByIdLoan449 I
(44I J
int44J M
id44N P
)44P Q
{55 	
try66 
{77 
using88 
(88 
var88 
r88 
=88 
RepositoryFactory88 0
.880 1
CreateRepository881 A
(88A B
)88B C
)88C D
{99 
var:: 
loan:: 
=:: 
r::  
.::  !
Retrieve::! )
<::) *
Loan::* .
>::. /
(::/ 0
p::0 1
=>::2 4
p::5 6
.::6 7
loan_id::7 >
==::? A
id::B D
)::D E
;::E F
if;; 
(;; 
loan;; 
==;; 
null;;  $
);;$ %
{<< 
return== 
(==  
false==  %
,==% &
$str==' ?
,==? @
null==A E
)==E F
;==F G
}>> 
return?? 
(?? 
true??  
,??  !
$str??" 7
,??7 8
loan??9 =
)??= >
;??> ?
}@@ 
}AA 
catchBB 
(BB 
	ExceptionBB 
exBB 
)BB  
{CC 
returnDD 
(DD 
falseDD 
,DD 
$"DD !
$strDD! A
{DDA B
exDDB D
.DDD E
MessageDDE L
}DDL M
"DDM N
,DDN O
nullDDP T
)DDT U
;DDU V
}EE 
}FF 	
publicHH 
(HH 
boolHH 
SuccessHH 
,HH 
stringHH $
MessageHH% ,
)HH, -
DeleteHH. 4
(HH4 5
intHH5 8
idHH9 ;
)HH; <
{II 	
tryJJ 
{KK 
varLL 
loanLL 
=LL 
RetrieveByIdLoanLL +
(LL+ ,
idLL, .
)LL. /
.LL/ 0
LoanLL0 4
;LL4 5
ifMM 
(MM 
loanMM 
==MM 
nullMM  
)MM  !
{NN 
returnOO 
(OO 
falseOO !
,OO! "
$strOO# ;
)OO; <
;OO< =
}PP 
usingRR 
(RR 
varRR 
rRR 
=RR 
RepositoryFactoryRR 0
.RR0 1
CreateRepositoryRR1 A
(RRA B
)RRB C
)RRC D
{SS 
boolTT 
deletedTT  
=TT! "
rTT# $
.TT$ %
DeleteTT% +
(TT+ ,
loanTT, 0
)TT0 1
;TT1 2
returnUU 
deletedUU "
?VV 
(VV 
trueVV 
,VV  
$strVV! B
)VVB C
:WW 
(WW 
falseWW  
,WW  !
$strWW" C
)WWC D
;WWD E
}XX 
}YY 
catchZZ 
(ZZ 
	ExceptionZZ 
exZZ 
)ZZ  
{[[ 
return\\ 
(\\ 
false\\ 
,\\ 
$"\\ !
$str\\! @
{\\@ A
ex\\A C
.\\C D
Message\\D K
}\\K L
"\\L M
)\\M N
;\\N O
}]] 
}^^ 	
public`` 
(`` 
bool`` 
Success`` 
,`` 
string`` $
Message``% ,
)``, -

UpdateLoan``. 8
(``8 9
Loan``9 =
loan``> B
)``B C
{aa 	
trybb 
{cc 
usingdd 
(dd 
vardd 
rdd 
=dd 
RepositoryFactorydd 0
.dd0 1
CreateRepositorydd1 A
(ddA B
)ddB C
)ddC D
{ee 
boolff 
updatedff  
=ff! "
rff# $
.ff$ %
Updateff% +
(ff+ ,
loanff, 0
)ff0 1
;ff1 2
returngg 
updatedgg "
?hh 
(hh 
truehh 
,hh  
$strhh! D
)hhD E
:ii 
(ii 
falseii  
,ii  !
$strii" E
)iiE F
;iiF G
}jj 
}kk 
catchll 
(ll 
	Exceptionll 
exll 
)ll  
{mm 
returnnn 
(nn 
falsenn 
,nn 
$"nn !
$strnn! B
{nnB C
exnnC E
.nnE F
MessagennF M
}nnM N
"nnN O
)nnO P
;nnP Q
}oo 
}pp 	
publicrr 
(rr 
boolrr 
Successrr 
,rr 
stringrr $
Messagerr% ,
,rr, -
Listrr. 2
<rr2 3
Loanrr3 7
>rr7 8
Loansrr9 >
)rr> ?!
RetrieveLoansByUserIdrr@ U
(rrU V
intrrV Y
userIdrrZ `
)rr` a
{ss 	
trytt 
{uu 
usingvv 
(vv 
varvv 
rvv 
=vv 
RepositoryFactoryvv 0
.vv0 1
CreateRepositoryvv1 A
(vvA B
)vvB C
)vvC D
{ww 
varxx 
loansxx 
=xx 
rxx  !
.xx! "
RetrieveAllxx" -
<xx- .
Loanxx. 2
>xx2 3
(xx3 4
)xx4 5
.xx5 6
Wherexx6 ;
(xx; <
loanxx< @
=>xxA C
loanxxD H
.xxH I
user_idxxI P
==xxQ S
userIdxxT Z
)xxZ [
.xx[ \
ToListxx\ b
(xxb c
)xxc d
;xxd e
ifyy 
(yy 
loansyy 
==yy  
nullyy! %
||yy& (
loansyy) .
.yy. /
Countyy/ 4
==yy5 7
$numyy8 9
)yy9 :
{zz 
return{{ 
({{  
false{{  %
,{{% &
$str{{' W
,{{W X
null{{Y ]
){{] ^
;{{^ _
}|| 
return}} 
(}} 
true}}  
,}}  !
$str}}" F
,}}F G
loans}}H M
)}}M N
;}}N O
}~~ 
} 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
return
ÇÇ 
(
ÇÇ 
false
ÇÇ 
,
ÇÇ 
$"
ÇÇ !
$str
ÇÇ! C
{
ÇÇC D
ex
ÇÇD F
.
ÇÇF G
Message
ÇÇG N
}
ÇÇN O
"
ÇÇO P
,
ÇÇP Q
null
ÇÇR V
)
ÇÇV W
;
ÇÇW X
}
ÉÉ 
}
ÑÑ 	
public
áá 
(
áá 
bool
áá 

IsEligible
áá 
,
áá  
string
áá! '
Message
áá( /
)
áá/ 0%
ValidateLoanEligibility
áá1 H
(
ááH I
Loan
ááI M
loan
ááN R
)
ááR S
{
àà 	
var
ââ 
userDataLogic
ââ 
=
ââ 
new
ââ  #
UserDataLogic
ââ$ 1
(
ââ1 2
)
ââ2 3
;
ââ3 4
var
ää 
(
ää 
success
ää 
,
ää 
message
ää !
,
ää! "
userData
ää# +
)
ää+ ,
=
ää- .
userDataLogic
ää/ <
.
ää< ="
RetrieveByIdUserData
ää= Q
(
ääQ R
loan
ääR V
.
ääV W
user_id
ääW ^
)
ää^ _
;
ää_ `
if
åå 
(
åå 
!
åå 
success
åå 
||
åå 
userData
åå $
==
åå% '
null
åå( ,
)
åå, -
{
çç 
return
éé 
(
éé 
false
éé 
,
éé 
$str
éé ^
)
éé^ _
;
éé_ `
}
èè 
decimal
íí !
monthlyInterestRate
íí '
=
íí( )
loan
íí* .
.
íí. /
interest_rate
íí/ <
/
íí= >
$num
íí? B
/
ííC D
$num
ííE G
;
ííG H
int
ìì 
totalPayments
ìì 
=
ìì 
loan
ìì  $
.
ìì$ %!
payment_term_months
ìì% 8
;
ìì8 9
decimal
îî 
monthlyPayment
îî "
=
îî# $
loan
îî% )
.
îî) *
requested_amount
îî* :
*
îî; <!
monthlyInterestRate
îî= P
*
îîQ R
(
ïï% &
decimal
ïï& -
)
ïï- .
Math
ïï. 2
.
ïï2 3
Pow
ïï3 6
(
ïï6 7
(
ïï7 8
double
ïï8 >
)
ïï> ?
(
ïï? @
$num
ïï@ A
+
ïïB C!
monthlyInterestRate
ïïD W
)
ïïW X
,
ïïX Y
totalPayments
ïïZ g
)
ïïg h
/
ïïi j
(
ññ% &
(
ññ& '
decimal
ññ' .
)
ññ. /
Math
ññ/ 3
.
ññ3 4
Pow
ññ4 7
(
ññ7 8
(
ññ8 9
double
ññ9 ?
)
ññ? @
(
ññ@ A
$num
ññA B
+
ññC D!
monthlyInterestRate
ññE X
)
ññX Y
,
ññY Z
totalPayments
ññ[ h
)
ññh i
-
ññj k
$num
ññl m
)
ññm n
;
ññn o
decimal
ôô 
maxAllowedPayment
ôô %
=
ôô& '
userData
ôô( 0
.
ôô0 1
salary
ôô1 7
*
ôô8 9
$num
ôô: ?
;
ôô? @
if
öö 
(
öö 
monthlyPayment
öö 
>
öö  
maxAllowedPayment
öö! 2
)
öö2 3
{
õõ 
return
úú 
(
úú 
false
úú 
,
úú 
$"
úú !
$str
úú! Q
{
úúQ R
monthlyPayment
úúR `
:
úú` a
$str
úúa b
}
úúb c
$strúúc Ñ
"úúÑ Ö
)úúÖ Ü
;úúÜ á
}
ùù 
if
°° 
(
°° 
userData
°° 
.
°° 
employment_status
°° *
!=
°°+ -
$num
°°. /
)
°°/ 0
{
¢¢ 
return
££ 
(
££ 
false
££ 
,
££ 
$str
££ b
)
££b c
;
££c d
}
§§ 
return
ßß 
(
ßß 
true
ßß 
,
ßß 
$str
ßß D
)
ßßD E
;
ßßE F
}
®® 	
}
´´ 
}¨¨ ó´
]C:\Users\ASUS TUF A15\source\repos\DesarrolloSeguro\BankSystem\Banck\BLL\AmortizationLogic.cs
	namespace 	
BLL
 
{ 
public		 

class		 
AmortizationLogic		 "
{

 
public 
( 
bool 
Success 
, 
string $
Message% ,
,, -
Amortization. :
Amortization; G
)G H
CreateAmortizationI [
([ \
Amortization\ h
amortizationi u
)u v
{ 	
Amortization 
res 
= 
null #
;# $
string 
message 
= 
string #
.# $
Empty$ )
;) *
bool 
success 
= 
false  
;  !
try 
{ 
using 
( 
var 
r 
= 
RepositoryFactory 0
.0 1
CreateRepository1 A
(A B
)B C
)C D
{ 
res 
= 
r 
. 
Create "
(" #
amortization# /
)/ 0
;0 1
if 
( 
res 
!= 
null #
)# $
{ 
success 
=  !
true" &
;& '
message 
=  !
$str" D
;D E
} 
else 
{ 
message 
=  !
$str" B
;B C
} 
} 
}   
catch!! 
(!! 
	Exception!! 
ex!! 
)!!  
{"" 
message## 
=## 
$"## 
$str## #
{### $
ex##$ &
.##& '
Message##' .
}##. /
"##/ 0
;##0 1
}$$ 
return&& 
(&& 
success&& 
,&& 
message&& $
,&&$ %
res&&& )
)&&) *
;&&* +
}'' 	
public)) 
()) 
bool)) 
Success)) 
,)) 
string)) $
Message))% ,
,)), -
List)). 2
<))2 3
Amortization))3 ?
>))? @
Amortizations))A N
)))N O#
RetrieveAllAmortization))P g
())g h
)))h i
{** 	
List++ 
<++ 
Amortization++ 
>++ 
res++ "
=++# $
null++% )
;++) *
string,, 
message,, 
=,, 
string,, #
.,,# $
Empty,,$ )
;,,) *
bool-- 
success-- 
=-- 
false--  
;--  !
try// 
{00 
using11 
(11 
var11 
r11 
=11 
RepositoryFactory11 0
.110 1
CreateRepository111 A
(11A B
)11B C
)11C D
{22 
res33 
=33 
r33 
.33 
RetrieveAll33 '
<33' (
Amortization33( 4
>334 5
(335 6
)336 7
;337 8
if44 
(44 
res44 
!=44 
null44 #
&&44$ &
res44' *
.44* +
Count44+ 0
>441 2
$num443 4
)444 5
{55 
success66 
=66  !
true66" &
;66& '
message77 
=77  !
$str77" K
;77K L
}88 
else99 
{:: 
message;; 
=;;  !
$str;;" D
;;;D E
}<< 
}== 
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
messageAA 
=AA 
$"AA 
$strAA #
{AA# $
exAA$ &
.AA& '
MessageAA' .
}AA. /
"AA/ 0
;AA0 1
}BB 
returnDD 
(DD 
successDD 
,DD 
messageDD $
,DD$ %
resDD& )
)DD) *
;DD* +
}EE 	
publicGG 
(GG 
boolGG 
SuccessGG 
,GG 
stringGG $
MessageGG% ,
,GG, -
AmortizationGG. :
AmortizationGG; G
)GGG H$
RetrieveByIdAmortizationGGI a
(GGa b
intGGb e
idGGf h
)GGh i
{HH 	
AmortizationII 
resII 
=II 
nullII #
;II# $
stringJJ 
messageJJ 
=JJ 
stringJJ #
.JJ# $
EmptyJJ$ )
;JJ) *
boolKK 
successKK 
=KK 
falseKK  
;KK  !
tryMM 
{NN 
usingOO 
(OO 
varOO 
rOO 
=OO 
RepositoryFactoryOO 0
.OO0 1
CreateRepositoryOO1 A
(OOA B
)OOB C
)OOC D
{PP 
resQQ 
=QQ 
rQQ 
.QQ 
RetrieveQQ $
<QQ$ %
AmortizationQQ% 1
>QQ1 2
(QQ2 3
pQQ3 4
=>QQ5 7
pQQ8 9
.QQ9 :
amortization_idQQ: I
==QQJ L
idQQM O
)QQO P
;QQP Q
ifRR 
(RR 
resRR 
!=RR 
nullRR #
)RR# $
{SS 
successTT 
=TT  !
trueTT" &
;TT& '
messageUU 
=UU  !
$strUU" ;
;UU; <
}VV 
elseWW 
{XX 
messageYY 
=YY  !
$strYY" >
;YY> ?
}ZZ 
}[[ 
}\\ 
catch]] 
(]] 
	Exception]] 
ex]] 
)]]  
{^^ 
message__ 
=__ 
$"__ 
$str__ #
{__# $
ex__$ &
.__& '
Message__' .
}__. /
"__/ 0
;__0 1
}`` 
returnbb 
(bb 
successbb 
,bb 
messagebb $
,bb$ %
resbb& )
)bb) *
;bb* +
}cc 	
publicee 
(ee 
boolee 
Successee 
,ee 
stringee $
Messageee% ,
)ee, -
Deleteee. 4
(ee4 5
intee5 8
idee9 ;
)ee; <
{ff 	
boolgg 
successgg 
=gg 
falsegg  
;gg  !
stringhh 
messagehh 
=hh 
stringhh #
.hh# $
Emptyhh$ )
;hh) *
tryjj 
{kk 
varll 
amortizationll  
=ll! "$
RetrieveByIdAmortizationll# ;
(ll; <
idll< >
)ll> ?
.ll? @
Amortizationll@ L
;llL M
ifmm 
(mm 
amortizationmm  
!=mm! #
nullmm$ (
)mm( )
{nn 
usingoo 
(oo 
varoo 
roo  
=oo! "
RepositoryFactoryoo# 4
.oo4 5
CreateRepositoryoo5 E
(ooE F
)ooF G
)ooG H
{pp 
successqq 
=qq  !
rqq" #
.qq# $
Deleteqq$ *
(qq* +
amortizationqq+ 7
)qq7 8
;qq8 9
messagerr 
=rr  !
successrr" )
?rr* +
$strrr, Q
:rrR S
$strrrT w
;rrw x
}ss 
}tt 
elseuu 
{vv 
messageww 
=ww 
$strww :
;ww: ;
}xx 
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
message|| 
=|| 
$"|| 
$str|| #
{||# $
ex||$ &
.||& '
Message||' .
}||. /
"||/ 0
;||0 1
}}} 
return 
( 
success 
, 
message $
)$ %
;% &
}
ÄÄ 	
public
ÇÇ 
(
ÇÇ 
bool
ÇÇ 
Success
ÇÇ 
,
ÇÇ 
string
ÇÇ $
Message
ÇÇ% ,
)
ÇÇ, - 
UpdateAmortization
ÇÇ. @
(
ÇÇ@ A
Amortization
ÇÇA M
amortization
ÇÇN Z
)
ÇÇZ [
{
ÉÉ 	
bool
ÑÑ 
success
ÑÑ 
=
ÑÑ 
false
ÑÑ  
;
ÑÑ  !
string
ÖÖ 
message
ÖÖ 
=
ÖÖ 
string
ÖÖ #
.
ÖÖ# $
Empty
ÖÖ$ )
;
ÖÖ) *
try
áá 
{
àà 
using
ââ 
(
ââ 
var
ââ 
r
ââ 
=
ââ 
RepositoryFactory
ââ 0
.
ââ0 1
CreateRepository
ââ1 A
(
ââA B
)
ââB C
)
ââC D
{
ää 
success
ãã 
=
ãã 
r
ãã 
.
ãã  
Update
ãã  &
(
ãã& '
amortization
ãã' 3
)
ãã3 4
;
ãã4 5
message
åå 
=
åå 
success
åå %
?
åå& '
$str
åå( O
:
ååP Q
$str
ååR w
;
ååw x
}
çç 
}
éé 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
êê 
message
ëë 
=
ëë 
$"
ëë 
$str
ëë #
{
ëë# $
ex
ëë$ &
.
ëë& '
Message
ëë' .
}
ëë. /
"
ëë/ 0
;
ëë0 1
}
íí 
return
îî 
(
îî 
success
îî 
,
îî 
message
îî $
)
îî$ %
;
îî% &
}
ïï 	
public
óó 
(
óó 
bool
óó 
Success
óó 
,
óó 
string
óó $
Message
óó% ,
,
óó, -
List
óó. 2
<
óó2 3
Amortization
óó3 ?
>
óó? @
Schedule
óóA I
)
óóI J%
GenerateAndSaveSchedule
óóK b
(
óób c
Loan
óóc g
loan
óóh l
)
óól m
{
òò 	
try
ôô 
{
öö 
List
õõ 
<
õõ 
Amortization
õõ !
>
õõ! "
schedule
õõ# +
=
õõ, -
new
õõ. 1
List
õõ2 6
<
õõ6 7
Amortization
õõ7 C
>
õõC D
(
õõD E
)
õõE F
;
õõF G
decimal
ùù  
remainingPrincipal
ùù *
=
ùù+ ,
loan
ùù- 1
.
ùù1 2
requested_amount
ùù2 B
;
ùùB C
int
ûû 
totalPayments
ûû !
=
ûû" #
loan
ûû$ (
.
ûû( )!
payment_term_months
ûû) <
;
ûû< =
decimal
üü !
monthlyInterestRate
üü +
=
üü, -
loan
üü. 2
.
üü2 3
interest_rate
üü3 @
/
üüA B
$num
üüC F
/
üüG H
$num
üüI K
;
üüK L
decimal
†† 
monthlyPayment
†† &
=
††' ( 
remainingPrincipal
††) ;
*
††< =!
monthlyInterestRate
††> Q
*
††R S
(
°°) *
decimal
°°* 1
)
°°1 2
Math
°°2 6
.
°°6 7
Pow
°°7 :
(
°°: ;
(
°°; <
double
°°< B
)
°°B C
(
°°C D
$num
°°D E
+
°°F G!
monthlyInterestRate
°°H [
)
°°[ \
,
°°\ ]
totalPayments
°°^ k
)
°°k l
/
°°m n
(
¢¢) *
(
¢¢* +
decimal
¢¢+ 2
)
¢¢2 3
Math
¢¢3 7
.
¢¢7 8
Pow
¢¢8 ;
(
¢¢; <
(
¢¢< =
double
¢¢= C
)
¢¢C D
(
¢¢D E
$num
¢¢E F
+
¢¢G H!
monthlyInterestRate
¢¢I \
)
¢¢\ ]
,
¢¢] ^
totalPayments
¢¢_ l
)
¢¢l m
-
¢¢n o
$num
¢¢p q
)
¢¢q r
;
¢¢r s
DateTime
§§ 
	startDate
§§ "
=
§§# $
loan
§§% )
.
§§) *
application_date
§§* :
??
§§; =
DateTime
§§> F
.
§§F G
Now
§§G J
;
§§J K
for
¶¶ 
(
¶¶ 
int
¶¶ 
i
¶¶ 
=
¶¶ 
$num
¶¶ 
;
¶¶ 
i
¶¶  !
<=
¶¶" $
totalPayments
¶¶% 2
;
¶¶2 3
i
¶¶4 5
++
¶¶5 7
)
¶¶7 8
{
ßß 
decimal
®® 
interestForPeriod
®® -
=
®®. / 
remainingPrincipal
®®0 B
*
®®C D!
monthlyInterestRate
®®E X
;
®®X Y
decimal
©© 
principalPayment
©© ,
=
©©- .
monthlyPayment
©©/ =
-
©©> ?
interestForPeriod
©©@ Q
;
©©Q R
Amortization
´´   
amortizationRecord
´´! 3
=
´´4 5
new
´´6 9
Amortization
´´: F
{
¨¨  
installment_number
≠≠ *
=
≠≠+ ,
i
≠≠- .
,
≠≠. /
due_date
ÆÆ  
=
ÆÆ! "
	startDate
ÆÆ# ,
.
ÆÆ, -
	AddMonths
ÆÆ- 6
(
ÆÆ6 7
i
ÆÆ7 8
)
ÆÆ8 9
,
ÆÆ9 :
payment_amount
ØØ &
=
ØØ' (
decimal
ØØ) 0
.
ØØ0 1
Round
ØØ1 6
(
ØØ6 7
monthlyPayment
ØØ7 E
,
ØØE F
$num
ØØG H
)
ØØH I
,
ØØI J
	principal
∞∞ !
=
∞∞" #
decimal
∞∞$ +
.
∞∞+ ,
Round
∞∞, 1
(
∞∞1 2
principalPayment
∞∞2 B
,
∞∞B C
$num
∞∞D E
)
∞∞E F
,
∞∞F G
remaining_balance
±± )
=
±±* +
decimal
±±, 3
.
±±3 4
Round
±±4 9
(
±±9 : 
remainingPrincipal
±±: L
-
±±M N
principalPayment
±±O _
,
±±_ `
$num
±±a b
)
±±b c
,
±±c d
loan_id
≤≤ 
=
≤≤  !
loan
≤≤" &
.
≤≤& '
loan_id
≤≤' .
}
≥≥ 
;
≥≥ 
schedule
µµ 
.
µµ 
Add
µµ  
(
µµ  ! 
amortizationRecord
µµ! 3
)
µµ3 4
;
µµ4 5 
remainingPrincipal
∂∂ &
-=
∂∂' )
principalPayment
∂∂* :
;
∂∂: ;
if
∑∑ 
(
∑∑  
remainingPrincipal
∑∑ *
<
∑∑+ ,
$num
∑∑- .
)
∑∑. / 
remainingPrincipal
∏∏ *
=
∏∏+ ,
$num
∏∏- .
;
∏∏. /
}
ππ 
using
ªª 
(
ªª 
var
ªª 
r
ªª 
=
ªª 
RepositoryFactory
ªª 0
.
ªª0 1
CreateRepository
ªª1 A
(
ªªA B
)
ªªB C
)
ªªC D
{
ºº 
foreach
ΩΩ 
(
ΩΩ 
var
ΩΩ  
amortization
ΩΩ! -
in
ΩΩ. 0
schedule
ΩΩ1 9
)
ΩΩ9 :
{
ææ 
r
øø 
.
øø 
Create
øø  
(
øø  !
amortization
øø! -
)
øø- .
;
øø. /
}
¿¿ 
}
¡¡ 
return
√√ 
(
√√ 
true
√√ 
,
√√ 
$str
√√ \
,
√√\ ]
schedule
√√^ f
)
√√f g
;
√√g h
}
ƒƒ 
catch
≈≈ 
(
≈≈ 
	Exception
≈≈ 
ex
≈≈ 
)
≈≈  
{
∆∆ 
return
«« 
(
«« 
false
«« 
,
«« 
$"
«« !
$str
««! A
{
««A B
ex
««B D
.
««D E
Message
««E L
}
««L M
"
««M N
,
««N O
null
««P T
)
««T U
;
««U V
}
»» 
}
…… 	
public
ÀÀ 
(
ÀÀ 
bool
ÀÀ 
Success
ÀÀ 
,
ÀÀ 
string
ÀÀ $
Message
ÀÀ% ,
,
ÀÀ, -
Amortization
ÀÀ. :
Amortization
ÀÀ; G
)
ÀÀG H
PayInstallment
ÀÀI W
(
ÀÀW X
int
ÀÀX [
amortizationId
ÀÀ\ j
)
ÀÀj k
{
ÃÃ 	
var
ŒŒ 
retrieveResult
ŒŒ 
=
ŒŒ  &
RetrieveByIdAmortization
ŒŒ! 9
(
ŒŒ9 :
amortizationId
ŒŒ: H
)
ŒŒH I
;
ŒŒI J
if
œœ 
(
œœ 
!
œœ 
retrieveResult
œœ 
.
œœ  
Success
œœ  '
||
œœ( *
retrieveResult
œœ+ 9
.
œœ9 :
Amortization
œœ: F
==
œœG I
null
œœJ N
)
œœN O
{
–– 
return
—— 
(
—— 
false
—— 
,
—— 
$str
—— <
,
——< =
null
——> B
)
——B C
;
——C D
}
““ 
var
‘‘ 
installment
‘‘ 
=
‘‘ 
retrieveResult
‘‘ ,
.
‘‘, -
Amortization
‘‘- 9
;
‘‘9 :
if
◊◊ 
(
◊◊ 
installment
◊◊ 
.
◊◊ 
payment_date
◊◊ (
.
◊◊( )
HasValue
◊◊) 1
)
◊◊1 2
{
ÿÿ 
return
ŸŸ 
(
ŸŸ 
true
ŸŸ 
,
ŸŸ 
$str
ŸŸ 7
,
ŸŸ7 8
installment
ŸŸ9 D
)
ŸŸD E
;
ŸŸE F
}
⁄⁄ 
installment
›› 
.
›› 
payment_date
›› $
=
››% &
DateTime
››' /
.
››/ 0
Now
››0 3
;
››3 4
var
‡‡ 
updateResult
‡‡ 
=
‡‡  
UpdateAmortization
‡‡ 1
(
‡‡1 2
installment
‡‡2 =
)
‡‡= >
;
‡‡> ?
if
·· 
(
·· 
!
·· 
updateResult
·· 
.
·· 
Success
·· %
)
··% &
{
‚‚ 
return
„„ 
(
„„ 
false
„„ 
,
„„ 
updateResult
„„ +
.
„„+ ,
Message
„„, 3
,
„„3 4
null
„„5 9
)
„„9 :
;
„„: ;
}
‰‰ 
var
ËË 
allScheduleResult
ËË !
=
ËË" #%
RetrieveAllAmortization
ËË$ ;
(
ËË; <
)
ËË< =
;
ËË= >
if
ÈÈ 
(
ÈÈ 
!
ÈÈ 
allScheduleResult
ÈÈ "
.
ÈÈ" #
Success
ÈÈ# *
||
ÈÈ+ -
allScheduleResult
ÈÈ. ?
.
ÈÈ? @
Amortizations
ÈÈ@ M
==
ÈÈN P
null
ÈÈQ U
)
ÈÈU V
{
ÍÍ 
return
ÎÎ 
(
ÎÎ 
false
ÎÎ 
,
ÎÎ 
$str
ÎÎ R
,
ÎÎR S
installment
ÎÎT _
)
ÎÎ_ `
;
ÎÎ` a
}
ÏÏ 
var
ÔÔ 
schedule
ÔÔ 
=
ÔÔ 
allScheduleResult
ÔÔ ,
.
ÔÔ, -
Amortizations
ÔÔ- :
.
ÔÔ: ;
Where
ÔÔ; @
(
ÔÔ@ A
a
ÔÔA B
=>
ÔÔC E
a
ÔÔF G
.
ÔÔG H
loan_id
ÔÔH O
==
ÔÔP R
installment
ÔÔS ^
.
ÔÔ^ _
loan_id
ÔÔ_ f
)
ÔÔf g
.
ÔÔg h
ToList
ÔÔh n
(
ÔÔn o
)
ÔÔo p
;
ÔÔp q
int
ÒÒ 
cuotasPagadas
ÒÒ 
=
ÒÒ 
schedule
ÒÒ  (
.
ÒÒ( )
Count
ÒÒ) .
(
ÒÒ. /
a
ÒÒ/ 0
=>
ÒÒ1 3
a
ÒÒ4 5
.
ÒÒ5 6
payment_date
ÒÒ6 B
.
ÒÒB C
HasValue
ÒÒC K
)
ÒÒK L
;
ÒÒL M
int
ÚÚ 
totalCuotas
ÚÚ 
=
ÚÚ 
schedule
ÚÚ &
.
ÚÚ& '
Count
ÚÚ' ,
;
ÚÚ, -
if
ıı 
(
ıı 
cuotasPagadas
ıı 
==
ıı  
totalCuotas
ıı! ,
)
ıı, -
{
ˆˆ 
var
¯¯ 
	loanLogic
¯¯ 
=
¯¯ 
new
¯¯  #
	LoanLogic
¯¯$ -
(
¯¯- .
)
¯¯. /
;
¯¯/ 0
var
˙˙ 

loanResult
˙˙ 
=
˙˙  
	loanLogic
˙˙! *
.
˙˙* +
RetrieveByIdLoan
˙˙+ ;
(
˙˙; <
installment
˙˙< G
.
˙˙G H
loan_id
˙˙H O
)
˙˙O P
;
˙˙P Q
if
˚˚ 
(
˚˚ 

loanResult
˚˚ 
.
˚˚ 
Success
˚˚ &
&&
˚˚' )

loanResult
˚˚* 4
.
˚˚4 5
Loan
˚˚5 9
!=
˚˚: <
null
˚˚= A
)
˚˚A B
{
¸¸ 
var
˝˝ 
loan
˝˝ 
=
˝˝ 

loanResult
˝˝ )
.
˝˝) *
Loan
˝˝* .
;
˝˝. /
loan
ˇˇ 
.
ˇˇ 
status
ˇˇ 
=
ˇˇ  !
$num
ˇˇ" #
;
ˇˇ# $
var
ÄÄ 
updateLoanResult
ÄÄ (
=
ÄÄ) *
	loanLogic
ÄÄ+ 4
.
ÄÄ4 5

UpdateLoan
ÄÄ5 ?
(
ÄÄ? @
loan
ÄÄ@ D
)
ÄÄD E
;
ÄÄE F
if
ÅÅ 
(
ÅÅ 
updateLoanResult
ÅÅ (
.
ÅÅ( )
Success
ÅÅ) 0
)
ÅÅ0 1
{
ÇÇ 
updateResult
ÑÑ $
.
ÑÑ$ %
Message
ÑÑ% ,
+=
ÑÑ- /
$str
ÑÑ0 Z
;
ÑÑZ [
}
ÖÖ 
else
ÜÜ 
{
áá 
updateResult
ââ $
.
ââ$ %
Message
ââ% ,
+=
ââ- /
$str
ââ0 m
;
ââm n
}
ää 
}
ãã 
}
åå 
return
éé 
(
éé 
true
éé 
,
éé 
$str
éé 7
+
éé8 9
updateResult
éé: F
.
ééF G
Message
ééG N
,
ééN O
installment
ééP [
)
éé[ \
;
éé\ ]
}
èè 	
}
îî 
}ïï 