Í0
OC:\Users\ASUS TUF A15\source\repos\bancoNuevo\BankSystem\Banck\BLL\UserLogic.cs
	namespace 	
BLL
 
{ 
public 

class 
	UserLogic 
{ 
public 
User 
Create 
( 
User 
users  %
)% &
{ 	
User 
res 
= 
null 
; 
using 
( 
var 
r 
= 
RepositoryFactory ,
., -
CreateRepository- =
(= >
)> ?
)? @
{ 
users 
. 
status 
= 
$num  
;  !
users 
. 
registration_date '
=( )
DateTime* 2
.2 3
Now3 6
;6 7
res 
= 
r 
. 
Create "
(" #
users# (
)( )
;) *
return 
res 
; 
} 
} 	
public 
void 1
%validateExistingUserAndPasswordSecure 9
(9 :
User: >
user? C
)C D
{   	
using!! 
(!! 
var!! 
r!! 
=!! 
RepositoryFactory!! ,
.!!, -
CreateRepository!!- =
(!!= >
)!!> ?
)!!? @
{"" 
User## 
existingUser## !
=##" #
r##$ %
.##% &
Retrieve##& .
<##. /
User##/ 3
>##3 4
(##4 5
u##5 6
=>##7 9
u##: ;
.##; <
email##< A
==##B D
user##E I
.##I J
email##J O
)##O P
;##P Q
if$$ 
($$ 
existingUser$$ 
!=$$  "
null$$# '
)$$' (
{%% 
throw&& 
new&& 
	Exception&& '
(&&' (
$str&&( B
)&&B C
;&&C D
}'' 
if(( 
((( 
!(( 
ValidatePassword(( $
((($ %
user((% )
,(() *
user((+ /
.((/ 0
password((0 8
)((8 9
)((9 :
{)) 
throw** 
new** 
	Exception** '
(**' (
$str**( E
)**E F
;**F G
}++ 
},, 
}.. 	
public00 
User00 
Authenticate00  
(00  !
string00! '
email00( -
,00- .
string00/ 5
password006 >
)00> ?
{11 	
using22 
(22 
var22 
r22 
=22 
RepositoryFactory22 ,
.22, -
CreateRepository22- =
(22= >
)22> ?
)22? @
{33 
User55 
user55 
=55 
r55 
.55 
Retrieve55 &
<55& '
User55' +
>55+ ,
(55, -
u55- .
=>55/ 1
u552 3
.553 4
email554 9
==55: <
email55= B
&&55C E
u55F G
.55G H
password55H P
==55Q S
password55T \
)55\ ]
;55] ^
if77 
(77 
user77 
==77 
null77  
)77  !
{88 
throw99 
new99 
System99 $
.99$ %'
UnauthorizedAccessException99% @
(99@ A
$str99A \
)99\ ]
;99] ^
}:: 
return<< 
user<< 
;<< 
}== 
}>> 	
private@@ 
bool@@ 
ValidatePassword@@ %
(@@% &
User@@& *
user@@+ /
,@@/ 0
string@@1 7
password@@8 @
)@@@ A
{AA 	
ifCC 
(CC 
passwordCC 
.CC 
LengthCC 
<CC  !
$numCC" $
)CC$ %
returnDD 
falseDD 
;DD 
ifGG 
(GG 
!GG 
RegexGG 
.GG 
IsMatchGG 
(GG 
passwordGG '
,GG' (
$strGG) C
)GGC D
)GGD E
returnHH 
falseHH 
;HH 
varKK 
userNamePartsKK 
=KK 
userKK  $
.KK$ %

first_nameKK% /
.KK/ 0
SplitKK0 5
(KK5 6
newKK6 9
charKK: >
[KK> ?
]KK? @
{KKA B
$charKKC F
,KKF G
$charKKH K
,KKK L
$charKKM P
,KKP Q
$charKKR U
}KKV W
,KKW X
StringSplitOptionsKKY k
.KKk l
RemoveEmptyEntriesKKl ~
)KK~ 
;	KK €
foreachLL 
(LL 
varLL 
partLL 
inLL  
userNamePartsLL! .
)LL. /
{MM 
ifNN 
(NN 
passwordNN 
.NN 
ContainsNN %
(NN% &
partNN& *
)NN* +
)NN+ ,
returnOO 
falseOO  
;OO  !
}PP 
varSS 

emailPartsSS 
=SS 
userSS !
.SS! "
emailSS" '
.SS' (
SplitSS( -
(SS- .
newSS. 1
charSS2 6
[SS6 7
]SS7 8
{SS9 :
$charSS; >
,SS> ?
$charSS@ C
,SSC D
$charSSE H
,SSH I
$charSSJ M
}SSN O
,SSO P
StringSplitOptionsSSQ c
.SSc d
RemoveEmptyEntriesSSd v
)SSv w
;SSw x
foreachTT 
(TT 
varTT 
partTT 
inTT  

emailPartsTT! +
)TT+ ,
{UU 
ifVV 
(VV 
passwordVV 
.VV 
ContainsVV %
(VV% &
partVV& *
)VV* +
)VV+ ,
returnWW 
falseWW  
;WW  !
}XX 
returnZZ 
trueZZ 
;ZZ 
}[[ 	
}__ 
}`` ˆ
]C:\Users\ASUS TUF A15\source\repos\bancoNuevo\BankSystem\Banck\BLL\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 
) 
]  
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str  
)  !
]! "
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[   
assembly   	
:  	 

AssemblyVersion   
(   
$str   $
)  $ %
]  % &
[!! 
assembly!! 	
:!!	 

AssemblyFileVersion!! 
(!! 
$str!! (
)!!( )
]!!) *